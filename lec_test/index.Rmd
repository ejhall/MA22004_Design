---
title: "MA22004 Statistics II - Lecture Notes"
author: "Dr Eric Hall [(ehall001@dundee.ac.uk)](mailto:ehall001@dundee.ac.uk)"
date: "`r Sys.Date()`"
output:
  bookdown::gitbook:
    config:
      toc:
        collapse: section
        scroll_highlight: yes
      toolbar:
        position: fixed
      download: ["pdf"]
      sharing: null
      fontsettings:
        theme: white
        family: sans
        size: 3
      info: yes
      highlight: pygments
  bookdown::pdf_book:
    keep_tex: yes
description: "University of Dundee, MA22004 Statistics II, Lecture 0."
---

```{r setup, include=FALSE}
# packages
library(bookdown)
library(plotly)
library(tidyverse)
library(latex2exp)
library(svglite)

knitr::opts_chunk$set(echo = TRUE, comment = "") #, dev = "svglite"
#plotly::config(plot_ly(), displaylogo = FALSE, mathjax = "cdn")
```

# Preliminaries: Special distributions {#special-dist}

## Normal distribution

A random variable $X$ with this distribution takes the form of a symmetric bell-shaped curve. The *location* (position) and *dispersion* (spread) of the distribution depends on the mean $\mu$ and variance $\sigma^2$, respectively. We write $X \sim \mathcal{N}(\mu, \sigma^2)$. Recall the *standard deviation* is the square root of the variance, i.e., $\sigma$. 

```{r normals-same-var, echo=FALSE, fig.cap="Two normal variates with different means and same variance."}
x <- seq(-8, 8, length=1000)
y0 <- dnorm(x, -2, 1)
y1 <- dnorm(x, 2, 1)
df <- tibble(x, y0, y1)

ggplot(data = df, aes(x = x)) + geom_line(aes(y=y0)) + geom_line(aes(y=y1)) 
```

```{r normals-same-mean, echo=FALSE, fig.cap="Two normal variates with different variance and same means."}
x <- seq(-8, 8, length=1000)
y0 <- dnorm(x, 0, 1)
y1 <- dnorm(x, 0, 3)
df <- tibble(x, y0, y1)

ggplot(data=df, aes(x=x)) + geom_line(aes(y=y0)) + geom_line(aes(y=y1)) 
```

## Computations with normals

The *standard normal* variable $Z$ has mean $\mu=0$ and variance $\sigma^2 = 1$. Probability values such as $P(Z \leq z)$ can be looked up in standard normal tables.

A random variable $X \sim \mathcal{N}(\mu, \sigma^2)$ can be transformed into a standard normal using the transformation,
\begin{equation}
Z = \frac{X - \mu}{\sigma} \,.
(\#eq:std-norm-transform)
\end{equation}

```{example norm-comp-1}
*Compute the probability that the random variable $X \sim \mathcal{N}(5,9)$ exceeds $5.5$.*
```
  
```{r comp-norm-1-plot, echo=FALSE, fig.cap="Standard normal $Z$ and the $X$"}
x <- seq(-14, 24, length=1000)
y0 <- dnorm(x, 0, 1)
y1 <- dnorm(x, 5.5, 9)
df <- tibble(x, y0, y1)

ggplot(data=df, aes(x=x)) + geom_line(aes(y=y0)) + geom_line(aes(y=y1)) 
```

We first transform $X \mapsto Z$ using \@ref(eq:std-norm-transform) and then look up the probability value up in a table of standard normal values ($Z$-score). 
\[
\begin{aligned}
P(X \geq 5.5) &= P\left(Z \geq \frac{5.5 - 5}{3}\right)\\
  &= P(Z \geq 0.167)\\
  &= P(Z \leq -0.167)\\
  &=0.4364 - 0.0028\\
  &=0.4346\,.
\end{aligned}
\]

Alternatively, we can use the code:
```{r comp-norm-1-code}
pnorm(5.5, mean=5, sd=9, lower.tail=FALSE)
```
Here we use the option `lower.tail=FALSE` as we are interested in the *upper tail* probability in this instance. 


```{example norm-comp-2}
*Compute the probability that the random variable $X \sim \mathcal{N}(5,9)$ is between\dots.*
```

## Properties of normals
