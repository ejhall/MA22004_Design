---
title: "Special distributions"
author: "Eric Hall [(ehall001@dundee.ac.uk)](mailto:ehall001@dundee.ac.uk)"
date: "`r Sys.Date()`"
output:
  learnr::tutorial:
    progressive: true
    allow_skip: true
runtime: shiny_prerendered
description: >
  University of Dundee, MA22004 Statistics II, Lecture 0.
---

```{r setup, include=FALSE}
# packages
library(learnr)
library(bookdown)
library(plotly)
library(tidyverse)
library(latex2exp)
#devtools::install_github("rstudio-education/gradethis")
library(gradethis)
#devtools::install_github("rundel/learnrhash")
library(learnrhash)

# tutorial options
tutorial_options(
  # code running in exercise times out after 30 seconds
  exercise.timelimit = 30, 
  # use gradethis for checking
  exercise.checker = gradethis::grade_learnr
  )

# hide non-exercise code chunks
knitr::opts_chunk$set(echo = FALSE, comment="")
#plotly::config(plot_ly(), displaylogo = FALSE, mathjax = "cdn")
```


## Normal distribution

A random variable $X$ with this distribution takes the form of a symmetric bell-shaped curve. The *location* (position) and *dispersion* (spread) of the distribution depends on the mean $\mu$ and variance $\sigma^2$, respectively. We write $X \sim \mathcal{N}(\mu, \sigma^2)$. Recall the *standard deviation* is the square root of the variance, i.e., $\sigma$.

```{r normals-same-var}
options( warn = -1 )

x <- seq(-8, 8, length=1000)

y0 <- dnorm(x, -2, 1)
y1 <- dnorm(x, 2, 1)

df <- tibble(x, y0, y1)

ggplot(data = df, aes(x = x)) + geom_line(aes(y=y0)) + geom_line(aes(y=y1)) 
  
# fig <- plot_ly(data = df, x = ~x) %>%
#   add_lines(y = ~y0, name="$\\mathcal{N}(0, 1)$")
# 
# # create data
# aval <- list()
# for(mu in 1:11){
#   aval[[mu]] <- list(visible = FALSE, 
#                      name = paste0('$\\mu$ = ', (mu-1)/10),
#                      x = x,
#                      y = dnorm(x, (mu-1)/10))
# }
# aval[3][[1]]$visible = TRUE
# 
# # create steps and plot all traces
# steps <- list()
# for (i in 1:11){
#   fig <- add_lines(fig, 
#                    x = aval[i][[1]]$x,
#                    y = aval[i][[1]]$y,
#                    visible = aval[i][[1]]$visible,
#                    name = aval[i][[1]]$name,
#                    type = 'scatter', 
#                    mode = 'lines', 
#                    hoverinfo = 'name', 
#                    line=list(color='00CED1'), 
#                    showlegend = FALSE)
#   step <- list(args = list('visible', 
#                            rep(FALSE, length(aval))),
#                method = 'restyle')
#   step$args[[2]][i] = TRUE  
#   steps[[i]] = step 
# }
# 
# # add slider control to plot
# fig <- fig %>%
#   layout(sliders = list(list(active = 3,
#                              currentvalue = list(prefix = "mu: "),
#                              steps = steps)))
# 
# # plot figure
# fig
```

```{r normals-same-mean}

x <- seq(-8, 8, length=1000)

y0 <- dnorm(x, 0, 1)
y1 <- dnorm(x, 0, 3)

df <- tibble(x, y0, y1)

ggplot(data = df, aes(x = x)) + geom_line(aes(y=y0)) + geom_line(aes(y=y1)) 
```

## Computations with normals

The *standard normal* variable $Z$ has mean $\mu=0$ and variance $\sigma^2 = 1$. Probability values such as $P(Z \leq z)$ can be looked up in standard normal tables.

A random variable $X \sim \mathcal{N}(\mu, \sigma^2)$ can be transformed into a standard normal using the transformation,
\begin{equation}
Z = \frac{X - \mu}{\sigma} \,.
\label{eq:std-norm-transform}
\end{equation}

### Example 1

*Compute the probability that the random variable $X \sim \mathcal{N}(5,9)$ exceeds $5.5$.*

```{r comp-norm-1-plot}

x <- seq(-14, 24, length=1000)

y0 <- dnorm(x, 0, 1)
y1 <- dnorm(x, 5.5, 9)

df <- tibble(x, y0, y1)

ggplot(data = df, aes(x = x)) + geom_line(aes(y=y0)) + geom_line(aes(y=y1)) 
```

We first transform $X \mapsto Z$ using \@ref(eq:std-norm-transform) and then look up the probability value up in a table of standard normal values ($Z$-scoare). 
\[
\begin{aligned}
P(X \geq 5.5) &= P\left(Z \geq \frac{5.5 - 5}{3}\right)\\
  &= P(Z \geq 0.167)\\
  &= P(Z \leq -0.167)\\
  &=0.4364 - 0.0028\\
  &=0.4346\,.
\end{aligned}
\]

Alternatively, we can use the code:

```{r comp-norm-1-code, echo = TRUE}
pnorm(5.5, mean=5, sd=9, lower.tail=FALSE)
```

Here we use the option `lower.tail=FALSE` as we are interested in the *upper tail* probability in this instance. 

### Example 2

*Compute the probability that the random variable $X \sim \mathcal{N}(5,9)$ is b $5.5$.*

\[
\begin{aligned}
P(X \geq 5.5) &= P\left(Z \geq \frac{5.5 - 5}{3}\right)\\
  &= P(Z \geq 0.167)\\
  &= P(Z \leq -0.167)\\
  &=0.4364 - 0.0028\\
  &=0.4346\,.
\end{aligned}
\]

## Properties of normals
